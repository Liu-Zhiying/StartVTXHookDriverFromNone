#ifndef VMCS_H
#define VMCS_H

#include "Basic.h"

constexpr UINT32 VIRTUAL_PROCESSOR_ID =								0x00000000;  // 16-Bit Control Field
constexpr UINT32 POSTED_INTERRUPT_NOTIFICATION =					0x00000002;
constexpr UINT32 EPTP_INDEX =										0x00000004;
constexpr UINT32 GUEST_ES_SELECTOR =								0x00000800;  // 16-Bit Guest-State Fields
constexpr UINT32 GUEST_CS_SELECTOR =								0x00000802;
constexpr UINT32 GUEST_SS_SELECTOR =								0x00000804;
constexpr UINT32 GUEST_DS_SELECTOR =	 							0x00000806;
constexpr UINT32 GUEST_FS_SELECTOR = 								0x00000808;
constexpr UINT32 GUEST_GS_SELECTOR = 								0x0000080a;
constexpr UINT32 GUEST_LDTR_SELECTOR = 								0x0000080c;
constexpr UINT32 GUEST_TR_SELECTOR = 								0x0000080e;
constexpr UINT32 GUEST_INTERRUPT_STATUS = 							0x00000810;
constexpr UINT32 HOST_ES_SELECTOR = 								0x00000c00;  // 16-Bit Host-State Fields
constexpr UINT32 HOST_CS_SELECTOR = 								0x00000c02;
constexpr UINT32 HOST_SS_SELECTOR = 								0x00000c04;
constexpr UINT32 HOST_DS_SELECTOR = 								0x00000c06;
constexpr UINT32 HOST_FS_SELECTOR = 								0x00000c08;
constexpr UINT32 HOST_GS_SELECTOR = 								0x00000c0a;
constexpr UINT32 HOST_TR_SELECTOR = 								0x00000c0c;
constexpr UINT32 IO_BITMAP_A = 										0x00002000;  // 64-Bit Control Fields
constexpr UINT32 IO_BITMAP_A_HIGH = 								0x00002001;
constexpr UINT32 IO_BITMAP_B = 										0x00002002;
constexpr UINT32 IO_BITMAP_B_HIGH = 								0x00002003;
constexpr UINT32 MSR_BITMAP =										0x00002004;
constexpr UINT32 MSR_BITMAP_HIGH = 									0x00002005;
constexpr UINT32 VM_EXIT_MSR_STORE_ADDR = 							0x00002006;
constexpr UINT32 VM_EXIT_MSR_STORE_ADDR_HIGH = 						0x00002007;
constexpr UINT32 VM_EXIT_MSR_LOAD_ADDR = 							0x00002008;
constexpr UINT32 VM_EXIT_MSR_LOAD_ADDR_HIGH	=						0x00002009;
constexpr UINT32 VM_ENTRY_MSR_LOAD_ADDR	=							0x0000200a;
constexpr UINT32 VM_ENTRY_MSR_LOAD_ADDR_HIGH =						0x0000200b;
constexpr UINT32 EXECUTIVE_VMCS_POINTER	=							0x0000200c;
constexpr UINT32 EXECUTIVE_VMCS_POINTER_HIGH = 						0x0000200d;
constexpr UINT32 TSC_OFFSET	= 										0x00002010;
constexpr UINT32 TSC_OFFSET_HIGH = 									0x00002011;
constexpr UINT32 VIRTUAL_APIC_PAGE_ADDR = 							0x00002012;
constexpr UINT32 VIRTUAL_APIC_PAGE_ADDR_HIGH = 						0x00002013;
constexpr UINT32 APIC_ACCESS_ADDR = 								0x00002014;
constexpr UINT32 APIC_ACCESS_ADDR_HIGH = 							0x00002015;
constexpr UINT32 EPT_POINTER = 										0x0000201a;
constexpr UINT32 EPT_POINTER_HIGH = 								0x0000201b;
constexpr UINT32 EOI_EXIT_BITMAP_0 =								0x0000201c;
constexpr UINT32 EOI_EXIT_BITMAP_0_HIGH	=							0x0000201d;
constexpr UINT32 EOI_EXIT_BITMAP_1 = 								0x0000201e;
constexpr UINT32 EOI_EXIT_BITMAP_1_HIGH = 							0x0000201f;
constexpr UINT32 EOI_EXIT_BITMAP_2 = 								0x00002020;
constexpr UINT32 EOI_EXIT_BITMAP_2_HIGH =							0x00002021;
constexpr UINT32 EOI_EXIT_BITMAP_3 = 								0x00002022;
constexpr UINT32 EOI_EXIT_BITMAP_3_HIGH	=							0x00002023;
constexpr UINT32 EPTP_LIST_ADDRESS = 								0x00002024;
constexpr UINT32 EPTP_LIST_ADDRESS_HIGH = 							0x00002025;
constexpr UINT32 VMREAD_BITMAP_ADDRESS = 							0x00002026;
constexpr UINT32 VMREAD_BITMAP_ADDRESS_HIGH = 						0x00002027;
constexpr UINT32 VMWRITE_BITMAP_ADDRESS = 							0x00002028;
constexpr UINT32 VMWRITE_BITMAP_ADDRESS_HIGH = 						0x00002029;
constexpr UINT32 VIRTUALIZATION_EXCEPTION_INFO_ADDDRESS = 			0x0000202a;
constexpr UINT32 VIRTUALIZATION_EXCEPTION_INFO_ADDDRESS_HIGH =		0x0000202b;
constexpr UINT32 XSS_EXITING_BITMAP	=								0x0000202c;
constexpr UINT32 XSS_EXITING_BITMAP_HIGH = 							0x0000202d;
constexpr UINT32 GUEST_PHYSICAL_ADDRESS	=							0x00002400;  // 64-Bit Read-Only Data Field
constexpr UINT32 GUEST_PHYSICAL_ADDRESS_HIGH =						0x00002401;
constexpr UINT32 VMCS_LINK_POINTER	=								0x00002800;  // 64-Bit Guest-State Fields
constexpr UINT32 VMCS_LINK_POINTER_HIGH	=							0x00002801;
constexpr UINT32 GUEST_IA32_DEBUGCTL =								0x00002802;
constexpr UINT32 GUEST_IA32_DEBUGCTL_HIGH = 						0x00002803;
constexpr UINT32 GUEST_IA32_PAT	=									0x00002804;
constexpr UINT32 GUEST_IA32_PAT_HIGH = 								0x00002805;
constexpr UINT32 GUEST_IA32_EFER = 									0x00002806;
constexpr UINT32 GUEST_IA32_EFER_HIGH = 							0x00002807;
constexpr UINT32 GUEST_IA32_PERF_GLOBAL_CTRL= 						0x00002808;
constexpr UINT32 GUEST_IA32_PERF_GLOBAL_CTRL_HIGH = 				0x00002809;
constexpr UINT32 GUEST_PDPTR0 = 									0x0000280a;
constexpr UINT32 GUEST_PDPTR0_HIGH = 								0x0000280b;
constexpr UINT32 GUEST_PDPTR1 = 									0x0000280c;
constexpr UINT32 GUEST_PDPTR1_HIGH = 								0x0000280d;
constexpr UINT32 GUEST_PDPTR2 = 									0x0000280e;
constexpr UINT32 GUEST_PDPTR2_HIGH =								0x0000280f;
constexpr UINT32 GUEST_PDPTR3 =										0x00002810;
constexpr UINT32 GUEST_PDPTR3_HIGH =								0x00002811;
constexpr UINT32 HOST_IA32_PAT =									0x00002c00;  // 64-Bit Host-State Fields
constexpr UINT32 HOST_IA32_PAT_HIGH	=								0x00002c01;
constexpr UINT32 HOST_IA32_EFER	=									0x00002c02;
constexpr UINT32 HOST_IA32_EFER_HIGH = 								0x00002c03;
constexpr UINT32 HOST_IA32_PERF_GLOBAL_CTRL	 =						0x00002c04;
constexpr UINT32 HOST_IA32_PERF_GLOBAL_CTRL_HIGH = 					0x00002c05;
constexpr UINT32 PIN_BASED_VM_EXEC_CONTROL =						0x00004000;  // 32-Bit Control Fields
constexpr UINT32 CPU_BASED_VM_EXEC_CONTROL = 						0x00004002;
constexpr UINT32 EXCEPTION_BITMAP = 								0x00004004;
constexpr UINT32 PAGE_FAULT_ERROR_CODE_MASK = 						0x00004006;
constexpr UINT32 PAGE_FAULT_ERROR_CODE_MATCH = 						0x00004008;
constexpr UINT32 CR3_TARGET_COUNT =									0x0000400a;
constexpr UINT32 VM_EXIT_CONTROLS =									0x0000400c;
constexpr UINT32 VM_EXIT_MSR_STORE_COUNT =							0x0000400e;
constexpr UINT32 VM_EXIT_MSR_LOAD_COUNT	=							0x00004010;
constexpr UINT32 VM_ENTRY_CONTROLS = 								0x00004012;
constexpr UINT32 VM_ENTRY_MSR_LOAD_COUNT = 							0x00004014;
constexpr UINT32 VM_ENTRY_INTR_INFO_FIELD = 						0x00004016;
constexpr UINT32 VM_ENTRY_EXCEPTION_ERROR_CODE = 					0x00004018;
constexpr UINT32 VM_ENTRY_INSTRUCTION_LEN = 						0x0000401a;
constexpr UINT32 TPR_THRESHOLD = 									0x0000401c;
constexpr UINT32 SECONDARY_VM_EXEC_CONTROL = 						0x0000401e;
constexpr UINT32 PLE_GAP =											0x00004020;
constexpr UINT32 PLE_WINDOW =										0x00004022;
constexpr UINT32 VM_INSTRUCTION_ERROR =								0x00004400;  // 32-Bit Read-Only Data Fields
constexpr UINT32 VM_EXIT_REASON =									0x00004402;
constexpr UINT32 VM_EXIT_INTR_INFO =								0x00004404;
constexpr UINT32 VM_EXIT_INTR_ERROR_CODE =							0x00004406;
constexpr UINT32 IDT_VECTORING_INFO_FIELD =	 						0x00004408;
constexpr UINT32 IDT_VECTORING_ERROR_CODE =							0x0000440a;
constexpr UINT32 VM_EXIT_INSTRUCTION_LEN =							0x0000440c;
constexpr UINT32 VMX_INSTRUCTION_INFO =								0x0000440e;
constexpr UINT32 GUEST_ES_LIMIT	=									0x00004800;  // 32-Bit Guest-State Fields
constexpr UINT32 GUEST_CS_LIMIT =									0x00004802;
constexpr UINT32 GUEST_SS_LIMIT	=									0x00004804;
constexpr UINT32 GUEST_DS_LIMIT	=									0x00004806;
constexpr UINT32 GUEST_FS_LIMIT	=									0x00004808;
constexpr UINT32 GUEST_GS_LIMIT =									0x0000480a;
constexpr UINT32 GUEST_LDTR_LIMIT =									0x0000480c;
constexpr UINT32 GUEST_TR_LIMIT	=									0x0000480e;
constexpr UINT32 GUEST_GDTR_LIMIT =									0x00004810;
constexpr UINT32 GUEST_IDTR_LIMIT =									0x00004812;
constexpr UINT32 GUEST_ES_AR_BYTES =								0x00004814;
constexpr UINT32 GUEST_CS_AR_BYTES =								0x00004816;
constexpr UINT32 GUEST_SS_AR_BYTES =								0x00004818;
constexpr UINT32 GUEST_DS_AR_BYTES =								0x0000481a;
constexpr UINT32 GUEST_FS_AR_BYTES =	 							0x0000481c;
constexpr UINT32 GUEST_GS_AR_BYTES =								0x0000481e;
constexpr UINT32 GUEST_LDTR_AR_BYTES =								0x00004820;
constexpr UINT32 GUEST_TR_AR_BYTES =								0x00004822;
constexpr UINT32 GUEST_INTERRUPTIBILITY_INFO =						0x00004824;
constexpr UINT32 GUEST_ACTIVITY_STATE =								0x00004826;
constexpr UINT32 GUEST_SMBASE =										0x00004828;
constexpr UINT32 GUEST_SYSENTER_CS =								0x0000482a;
constexpr UINT32 VMX_PREEMPTION_TIMER_VALUE =						0x0000482e;
constexpr UINT32 HOST_SYSENTER_CS =							0x00004c00; // 32-Bit Host-State Field
constexpr UINT32 CR0_GUEST_HOST_MASK =								0x00006000; // Natural-Width Control Fields
constexpr UINT32 CR4_GUEST_HOST_MASK =								0x00006002;
constexpr UINT32 CR0_READ_SHADOW =									0x00006004;
constexpr UINT32 CR4_READ_SHADOW =									0x00006006;
constexpr UINT32 CR3_TARGET_VALUE0 =								0x00006008;
constexpr UINT32 CR3_TARGET_VALUE1 =								0x0000600a;
constexpr UINT32 CR3_TARGET_VALUE2 =								0x0000600c;
constexpr UINT32 CR3_TARGET_VALUE3 =								0x0000600e;
constexpr UINT32 EXIT_QUALIFICATION	=								0x00006400;  // Natural-Width Read-Only Data Fields
constexpr UINT32 IO_RCX	=											0x00006402;
constexpr UINT32 IO_RSI	=											0x00006404;
constexpr UINT32 IO_RDI	=											0x00006406;
constexpr UINT32 IO_RIP	=											0x00006408;
constexpr UINT32 GUEST_LINEAR_ADDRESS = 							0x0000640a;
constexpr UINT32 GUEST_CR0 =										0x00006800;  // Natural-Width Guest-State Fields
constexpr UINT32 GUEST_CR3 =										0x00006802;
constexpr UINT32 GUEST_CR4 =										0x00006804;
constexpr UINT32 GUEST_ES_BASE =									0x00006806;
constexpr UINT32 GUEST_CS_BASE =									0x00006808;
constexpr UINT32 GUEST_SS_BASE = 									0x0000680a;
constexpr UINT32 GUEST_DS_BASE = 									0x0000680c;
constexpr UINT32 GUEST_FS_BASE =									0x0000680e;
constexpr UINT32 GUEST_GS_BASE = 									0x00006810;
constexpr UINT32 GUEST_LDTR_BASE = 									0x00006812;
constexpr UINT32 GUEST_TR_BASE = 									0x00006814;
constexpr UINT32 GUEST_GDTR_BASE = 									0x00006816;
constexpr UINT32 GUEST_IDTR_BASE = 									0x00006818;
constexpr UINT32 GUEST_DR7 = 										0x0000681a;
constexpr UINT32 GUEST_RSP = 										0x0000681c;
constexpr UINT32 GUEST_RIP = 										0x0000681e;
constexpr UINT32 GUEST_RFLAGS = 									0x00006820;
constexpr UINT32 GUEST_PENDING_DBG_EXCEPTIONS =						0x00006822;
constexpr UINT32 GUEST_SYSENTER_ESP = 								0x00006824;
constexpr UINT32 GUEST_SYSENTER_EIP =								0x00006826;
constexpr UINT32 HOST_CR0 = 										0x00006c00;  // Natural-Width Host-State Fields
constexpr UINT32 HOST_CR3 = 										0x00006c02;
constexpr UINT32 HOST_CR4 = 										0x00006c04;
constexpr UINT32 HOST_FS_BASE = 									0x00006c06;
constexpr UINT32 HOST_GS_BASE = 									0x00006c08;
constexpr UINT32 HOST_TR_BASE = 									0x00006c0a;
constexpr UINT32 HOST_GDTR_BASE =									0x00006c0c;
constexpr UINT32 HOST_IDTR_BASE = 									0x00006c0e;
constexpr UINT32 HOST_SYSENTER_ESP =							0x00006c10;
constexpr UINT32 HOST_SYSENTER_EIP	= 							0x00006c12;
constexpr UINT32 HOST_RSP =											0x00006c14;
constexpr UINT32 HOST_RIP = 										0x00006c16;

typedef struct _VMCS
{
    ULONG RevisionId;
    ULONG AbortIndicator;
    UCHAR Data[PAGE_SIZE - 2 * sizeof(ULONG)];
} VMCS, * PVMCS;

#endif